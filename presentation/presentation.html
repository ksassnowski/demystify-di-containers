<html>
<head>
    <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="node_modules/reveal.js/css/theme/sky.css">
    <link rel="stylesheet" href="node_modules/reveal.js/lib/css/zenburn.css">
    <script src="node_modules/headjs/dist/1.0.0/head.js"></script>

    <style>
        .reveal pre code {
            font-size: 1.1rem;
            line-height: 1.3;
            max-height: 80%;
        }

        mark {
            background-color: #fff;
        }
    </style>
</head>

<body>
<div class="reveal">
    <div class="slides">
        <section>
            <h2>Demystifying Dependency Injection Containers</h2>
            <p>Kai Sassnowski</p>
            <small>kai-sassnowski.com - @warsh33p - github.com/ksassnowski</small>
        </section>


        <section>
            <section>
                <h2>Dependency Injection</h2>
            </section>

            <section>
                        <pre><code data-trim class="php">
                        class SessionStorage
                        {
                            public function __construct($cookieName = 'PHP_SESS_ID')
                            {
                                session_name($cookieName);
                                session_start();
                            }

                            public function set($key, $value)
                            {
                                $_SESSION[$key] = $value;
                            }

                            public function get($key)
                            {
                                return $_SESSION[$key];
                            }
                        }
                        </code></pre>
            </section>

            <section>
                <pre><code class="php" data-trim="">
                    class User
                    {
                        protected $storage;

                        function __construct()
                        {
                            $this->storage = new SessionStorage();
                        }

                        function setLanguage($language)
                        {
                            $this->storage->set('language', $language);
                        }

                        function getLanguage()
                        {
                            return $this->storage->get('language');
                        }

                        // ...
                    }
                </code></pre>
            </section>

            <section>
                <pre><code class="php" data-trim data-noescape>
                    class User
                    {
                        protected $storage;

                        function __construct()
                        {
                            <mark>$this->storage = new SessionStorage();</mark>
                        }

                        function setLanguage($language)
                        {
                            $this->storage->set('language', $language);
                        }

                        function getLanguage()
                        {
                            return $this->storage->get('language');
                        }

                        // ...
                    }
                </code></pre>
            </section>

            <section>
                <pre><code class="php" data-trim data-noescape>
                    class User
                    {
                        protected $storage;

                        <mark>function __construct(SessionStorage $storage)</mark>
                        {
                            <mark>$this->storage = $storage;</mark>
                        }

                        function setLanguage($language)
                        {
                            $this->storage->set('language', $language);
                        }

                        function getLanguage()
                        {
                            return $this->storage->get('language');
                        }

                        // ...
                    }
                </code></pre>
            </section>

            <section>
                <pre><code class="php" data-trim>
                    $storage = new SessionStorage();
                    $user = new User($storage);
                </code></pre>
            </section>

            <section>
                <h2>However...</h2>
            </section>

            <section>
                <pre><code class="php" data-trim>
                    $svc = new ShippingService(new ProductLocator(),
                       new PricingService(), new InventoryService(),
                       new TrackingRepository(new ConfigProvider()),
                       new Logger(new EmailLogger(new ConfigProvider())));
                </code></pre>
            </section>

            <section>
                <pre><code class="php" data-trim>
                    // Magic!
                    $svc = $container->get(ShippingService::class);
                </code></pre>
            </section>
        </section>

        <section>
            <section>
                <h2>Three stages of magic</h2>
            </section>

            <section>
                <h3>Euphoria</h3>

                <p class="fragment">I'm getting so much done!</p>
                <p class="fragment">This is so easy!</p>
                <p class="fragment">It just works (tm)!</p>
            </section>

            <section>
                <h3>Wariness</h3>

                <p class="fragment">How does this work?</p>
                <p class="fragment">It stopped working, now what?</p>
                <p class="fragment">What is even going on?</p>
            </section>

            <section>
                <h3>Understanding</h3>

                <p class="fragment">It's not magic</p>
                <p class="fragment">It's just another abstraction</p>
                <p class="fragment">I know where to look if things break</p>
            </section>

            <section>
                <blockquote>If you understand how things work they stop being "magic".</blockquote>
            </section>
        </section>

        <section>
            <h3>Let's write our own!</h3>
        </section>
    </div>
</div>

<script src="node_modules/reveal.js/js/reveal.js"></script>
<script>
    Reveal.initialize({
        dependencies: [
            {
                src: 'node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function () {
                    hljs.initHighlightingOnLoad();
                }
            },
        ]
    });
</script>
</body>
</html>
